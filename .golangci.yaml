version: "2"

run:
  timeout: 30m
  tests: false
issues:
  max-same-issues: 0
linters:
  default: none
  enable: # please keep this alphabetized
    # Don't use soon to deprecated[1] linters that lead to false
    # https://github.com/golangci/golangci-lint/issues/1841
    # - deadcode
    # - structcheck
    # - varcheck
    - ineffassign
    - nakedret
    - revive
    - staticcheck
    - unconvert # Remove unnecessary type conversions
    - unparam
    - unused
  settings: # please keep this alphabetized
    nakedret:
      # Align with https://github.com/alexkohler/nakedret/blob/v1.0.2/cmd/nakedret/main.go#L10
      max-func-lines: 5
    revive:
      severity: warning
      confidence: 0.8
      enable-all-rules: false
      rules:
        - name: blank-imports
          severity: warning
          disabled: false
        - name: context-as-argument
          severity: warning
          disabled: false
        - name: dot-imports
          severity: warning
          disabled: false
        - name: error-return
          severity: warning
          disabled: false
        - name: error-naming
          severity: warning
          disabled: false
        - name: if-return
          severity: warning
          disabled: false
        - name: increment-decrement
          severity: warning
          disabled: false
        - name: var-declaration
          severity: warning
          disabled: false
        - name: package-comments
          severity: warning
          disabled: true
        - name: range
          severity: warning
          disabled: false
        - name: receiver-naming
          severity: warning
          disabled: false
        - name: time-naming
          severity: warning
          disabled: false
        - name: indent-error-flow
          severity: warning
          disabled: false
        - name: errorf
          severity: warning
          disabled: false
        - name: context-keys-type
          severity: warning
          disabled: false
        - name: error-strings
          severity: warning
          disabled: false
        - name: var-naming
          disabled: false
          arguments:
            - []
            - ["GRPC", "WAL"]
        # TODO: enable the following rules
        - name: exported
          disabled: true
        - name: unexported-return
          disabled: true
    staticcheck:
      checks:
        - all
        - -SA1019 # TODO(fix) Using a deprecated function, variable, constant or field
        - -SA2002 # TODO(fix) Called testing.T.FailNow or SkipNow in a goroutine, which isnâ€™t allowed
  exclusions:
    # Excluding configuration per-path, per-linter, per-text and per-source
    rules:
      # exclude ineffassing linter for generated files for conversion
      - path: conversion\.go
        linters:
          - ineffassign
    paths:
      - ^zz_generated.*
